#include <Eigen/Eigen>
#include <math.h>
#include <stdio.h>

namespace rob_param
{
void forwardkin(StampedTransform t, Eigen::Matrix(double, 6, 1) jointval)
{
  double* q* q = jointval[0];

  double s1 = sin(*q), c1 = cos(*q);
  q++;
  double q234 = *q, s2 = sin(*q), c2 = cos(*q);
  q++;
  double s3 = sin(*q), c3 = cos(*q);
  q234 += *q;
  q++;
  q234 += *q;
  q++;
  double s5 = sin(*q), c5 = cos(*q);
  q++;
  double s6 = sin(*q), c6 = cos(*q);
  double s234 = sin(q234), c234 = cos(q234);
  t[0][0] = ((c1 * c234 - s1 * s234) * s5) / 2.0 - c5 * s1
    + ((c1 * c234 + s1 * s234) * s5) / 2.0;

  t[0][1] =
    (c6
       * (s1 * s5 + ((c1 * c234 - s1 * s234) * c5) / 2.0 + ((c1 * c234 + s1 * s234) * c5) / 2.0)
     - (s6 * ((s1 * c234 + c1 * s234) - (s1 * c234 - c1 * s234))) / 2.0);
  t[0][2] =
    (-(c6 * ((s1 * c234 + c1 * s234) - (s1 * c234 - c1 * s234))) / 2.0
     - s6
       * (s1 * s5 + ((c1 * c234 - s1 * s234) * c5) / 2.0 + ((c1 * c234 + s1 * s234) * c5) / 2.0));
  t[0][3] =
    ((d5 * (s1 * c234 - c1 * s234)) / 2.0 - (d5 * (s1 * c234 + c1 * s234)) / 2.0
     - d4 * s1 + (d6 * (c1 * c234 - s1 * s234) * s5) / 2.0
     + (d6 * (c1 * c234 + s1 * s234) * s5) / 2.0 - a2 * c1 * c2 - d6 * c5 * s1
     - a3 * c1 * c2 * c3 + a3 * c1 * s2 * s3);
  t[1][0] = c1 * c5 + ((s1 * c234 + c1 * s234) * s5) / 2.0
    + ((s1 * c234 - c1 * s234) * s5) / 2.0;
  t[1][1] =
    (c6
       * (((s1 * c234 + c1 * s234) * c5) / 2.0 - c1 * s5 + ((s1 * c234 - c1 * s234) * c5) / 2.0)
     + s6 * ((c1 * c234 - s1 * s234) / 2.0 - (c1 * c234 + s1 * s234) / 2.0));
  t[1][2] =
    (c6 * ((c1 * c234 - s1 * s234) / 2.0 - (c1 * c234 + s1 * s234) / 2.0)
     - s6
       * (((s1 * c234 + c1 * s234) * c5) / 2.0 - c1 * s5 + ((s1 * c234 - c1 * s234) * c5) / 2.0));
  t[1][3] =
    ((d5 * (c1 * c234 - s1 * s234)) / 2.0 - (d5 * (c1 * c234 + s1 * s234)) / 2.0
     + d4 * c1 + (d6 * (s1 * c234 + c1 * s234) * s5) / 2.0
     + (d6 * (s1 * c234 - c1 * s234) * s5) / 2.0 + d6 * c1 * c5 - a2 * c2 * s1
     - a3 * c2 * c3 * s1 + a3 * s1 * s2 * s3);
  t[2][0] = ((c234 * c5 - s234 * s5) / 2.0 - (c234 * c5 + s234 * s5) / 2.0);
  t[2][1] =
    ((s234 * c6 - c234 * s6) / 2.0 - (s234 * c6 + c234 * s6) / 2.0
     - s234 * c5 * c6);
  t[2][2] =
    (s234 * c5 * s6 - (c234 * c6 + s234 * s6) / 2.0
     - (c234 * c6 - s234 * s6) / 2.0);
  t[2][3] =
    (d1 + (d6 * (c234 * c5 - s234 * s5)) / 2.0 + a3 * (s2 * c3 + c2 * s3)
     + a2 * s2 - (d6 * (c234 * c5 + s234 * s5)) / 2.0 - d5 * c234);
  t[3][0] = 0.0;
  t[3][1] = 0.0;
  t[3][2] = 0.0;
  t[3][3] = 1.0;
}
};  // namespace rob_param
